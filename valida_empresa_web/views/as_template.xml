<?xml version="1.0" encoding="utf-8" ?>
<odoo>
  <data>
    <template id="external_layout_foji" inherit_id="website_sale.address">
      <xpath expr="//input[@name='field_required']" position="replace">
        <input type="hidden" name="field_required" t-att-value="'phone,name,vat,company_name'" />
      </xpath>
    </template>
    <template id="confirmation_foji" inherit_id="website_sale.confirmation">
      <xpath expr="//div[@id='wrap']" position="replace">
        <div id="wrap">
          <t t-if="order.state != 'sale'">
            <div class="container oe_website_sale">
              <ul class="wizard pull-center hidden-xs">
                <li t-att-class="step==10 and 'text-primary' or 'text-muted'" id="step10">
               
                  <a t-att-href="step_review_order and '/shop/cart' or '#'"
                    t-att-class="step_review_order and 'text-success' or 'o_link_disable'">
                    <span>Review Order</span>
                  </a>
                  <span class="chevron" />
                </li>
                <li t-att-class="(step==20 and 'text-primary') or 'text-muted'" id="step20">
                  <!-- why website_sale_order is not set here ? -->
                
                  <a t-att-href="step_billing and '/shop/checkout' or '#'"
                    t-att-class="step_billing and 'text-success' or ('o_link_disable' + ('' if step == 20 else ' text-muted'))">
                    <!-- billing if not loggedin - TODO -->
                    <t t-set="website_sale_order" t-value="website.sale_get_order()" />
                    <span>Billing</span>
                    <t
                      t-if="not website_sale_order or not website_sale_order.website_order_line or not website_sale_order.only_services">
                      <span> &amp; Shipping</span></t>
                    <span class="chevron" />
                  </a>
                </li>
                <li t-att-class="(step==40 and 'text-primary') or 'text-muted'" id="step40">
                  Payment<span class="chevron"></span>
                </li>
                <li class="text-primary" t-att-class="(step==50 and 'text-primary') or 'text-muted'" id="step50">
                  Confirmation<span class="chevron"></span>
                </li>

              </ul>
              <div class="row">
                <div class="col-md-9">
                  <div class="oe_cart">
              <br/>
              <br/>
                    <div t-if="request.params.get('message',False)" class="alert alert-success">
                      <t t-esc="request.params.get('message',False)" />
                    </div>
                    <div t-if="request.params.get('warning',False)" class="alert alert-danger">
                      <t t-esc="request.params.get('warning',False)" />
                    </div>
                    <div t-if="not website_sale_order or not website_sale_order.website_order_line"
                      class="js_cart_lines well well-lg">
                      Tu Carrito es Vacio!
                    </div>
                    <a href="/shop" class="btn btn-default mb32">
                      <span class="fa fa-long-arrow-left" />
                      <span class="hidden-xs">Continuar compra</span>
                      <span class="visible-xs-inline">Continuar</span>
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </t>
          <t t-if="order.state == 'sale'">
            <div class="container oe_website_sale">
              <div class="row">
                <div class="col-md-9">
                  <h1 class="mb32"><span>Order</span> <em t-field="order.name" />
                    <t t-if="order.state == 'sale'"><span>Confirmed</span></t>
                  </h1>
                  <div class="thanks_msg">
                    <h2>Thank you for your order.
                      <a class="btn btn-primary pull-right hidden-xs" href="/shop/print" target="_blank"><i
                          class="fa fa-print"></i> Print</a>
                    </h2>
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col-md-9">
                  <div class="oe_cart">
                    <h3 class="mt32 text-left">
                      <strong>Order Details:</strong>
                    </h3>
                    <table class="table table-striped table-condensed">
                      <thead>
                        <tr>
                          <th class='td-product_name'>Product</th>
                          <th class='td-qty'>Quantity</th>
                          <th class="text-right td-price">Unit Price</th>
                          <th class="text-right td-price-total">Subtotal</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr t-foreach="order.order_line" t-as="line">
                          <td class='td-product_name'>
                            <div>
                              <a t-attf-href="/shop/product/#{ slug(line.product_id.product_tmpl_id) }">
                                <strong t-esc="line.product_id.with_context(display_default_code=False).display_name" />
                              </a>
                            </div>
                            <div class="text-muted hidden-xs small">
                              <t t-foreach="line.name.splitlines()[1:]" t-as="name_line">
                                <span>
                                  <t t-esc="name_line" /></span><br />
                              </t>
                            </div>
                          </td>
                          <td class='td-qty'>
                            <div id="quote_qty">
                              <span
                                t-esc="int(line.product_uom_qty) == line.product_uom_qty and int(line.product_uom_qty) or line.product_uom_qty" />
                              <span class='hidden-xs' t-field="line.product_uom" groups="product.group_uom" />
                            </div>
                          </td>
                          <td class='td-price'>
                            <span class="text-right">
                              <div t-field="line.price_unit"
                                t-options='{"widget": "monetary", "display_currency": order.pricelist_id.currency_id}' />
                            </span>
                          </td>
                          <td class='td-price-total'>
                            <div class="text-right" t-field="line.price_subtotal"
                              t-options='{"widget": "monetary", "display_currency": order.pricelist_id.currency_id}' />
                          </td>
                        </tr>
                      </tbody>
                    </table>
                    <table class='table'>
                      <tr>
                        <td class="col-md-8"></td>
                        <td class="text-right-not-xs text-left-xs col-sm-2 col-xs-3">Subtotal:</td>
                        <td class="text-right col-sm-2 col-xs-3">
                          <span t-field="order.amount_untaxed" style="white-space: nowrap;"
                            t-options="{'widget': 'monetary','from_currency': order.pricelist_id.currency_id,'display_currency': website.currency_id}" />
                        </td>
                      </tr>
                      <tr>
                        <td class='noborder'></td>
                        <td class="text-right noborder">Taxes:</td>
                        <td class="text-right-not-xs text-left-xs noborder">
                          <span t-field="order.amount_tax" style="white-space: nowrap;"
                            t-options="{'widget': 'monetary', 'from_currency': order.pricelist_id.currency_id, 'display_currency': website.currency_id}" />
                        </td>
                      </tr>
                      <tr>
                        <td class='noborder'></td>
                        <td class="text-right"><strong>Total:</strong></td>
                        <td class="text-right-not-xs text-left-xs">
                          <strong t-field="order.amount_total"
                            t-options='{"widget": "monetary", "display_currency": order.pricelist_id.currency_id}' />
                        </td>
                      </tr>
                    </table>
                    <div class="clearfix" />
                    <div class="oe_structure" />
                    <h3 class="text-left">
                      <strong>Payment Information:</strong>
                    </h3>
                    <table class="table">
                      <tbody>
                        <tr>
                          <td colspan="2">
                            <t t-esc="order.payment_acquirer_id.name" />
                          </td>
                          <td class="text-right" width="100">
                            <strong>Total:</strong>
                          </td>
                          <td class="text-right" width="100">
                            <strong t-field="order.amount_total"
                              t-options="{'widget': 'monetary', 'display_currency': order.pricelist_id.currency_id}" />
                          </td>
                        </tr>
                      </tbody>
                    </table>
                    <t t-call="website_sale.payment_confirmation_status" />
                    <t
                      t-if="request.env['ir.config_parameter'].sudo().get_param('auth_signup.allow_uninvited') == 'True' and request.website.is_public_user()">
                      <p class='alert alert-info mt16'>
                        <a t-att-href='order.partner_id.signup_prepare() and order.partner_id.signup_url'
                          class='btn btn-primary'>Sign Up</a>
                        Now to Follow Your Order
                      </p>
                    </t>
                  </div>
                </div>
                <div class="col-md-3 hidden-sm hidden-xs text-muted">
                  <h3 class='mt32'>&amp;nbsp;</h3>
                  <t t-call='website_sale.bill_to'>
                    <t t-set="order" t-value="order" />
                  </t>
                </div>
              </div>
            </div>
            <div class="oe_structure" />
          </t>
        </div>
      </xpath>
    </template>

  </data>
</odoo>